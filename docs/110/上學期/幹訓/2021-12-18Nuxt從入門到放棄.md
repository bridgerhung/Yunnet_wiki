---
title:  Nuxt
sidebar_position: 3
description: Nuxt
---

:::info
[åŸå§‹ MD by ç‰è](https://hackmd.io/@minouo/rkhi-EU7t#/)
:::

*Min*

---

## CSR vs SSR

----

### CSR
##### Client-Side Rendering

----

![](https://i.imgur.com/5lTujAC.png)

----

* å„ªé»
    * render é€Ÿåº¦å¿«
    * èƒ½å¤ æ¸›è¼•Serverè² æ“”
* ç¼ºé»
    * SEOä¸ä½³
    * åˆæ¬¡è®€å–ä¹…

----

### SSR
##### Server-Side Rendering

----

æ˜¯ç¶²é ä¸Šé¢å‘ˆç¾çš„å…§å®¹åœ¨ä¼ºæœå™¨ç«¯å°±å·²ç¶“ç”Ÿæˆå¥½äº†ï¼Œç•¶ç”¨æˆ¶ç€è¦½ç¶²é æ™‚ï¼Œä¼ºæœå™¨æŠŠé€™å€‹åœ¨æœå‹™ç«¯ç”Ÿæˆå¥½çš„å®Œæ•´çš„htmlçµæ§‹å…§å®¹éŸ¿æ‡‰çµ¦ç€è¦½å™¨ï¼Œè€Œç€è¦½å™¨æ‹¿åˆ°é€™å€‹å®Œæ•´çš„htmlçµæ§‹å…§å®¹å¾Œç›´æ¥é¡¯ç¤º(æ¸²æŸ“)åœ¨é é¢ä¸Šçš„éç¨‹ã€‚

----

![](https://i.imgur.com/HcnOqx0.png)

---

## ğŸ‰ğŸ‰Nuxtèª•ç”Ÿå•¦ğŸ‰ğŸ‰

----

### ä»‹ç´¹
Nuxt.js æ˜¯ä¸€å€‹åŸºæ–¼ Vue.jsã€ç”¨ä¾†è™•ç†ä¼ºæœå™¨æ¸²æŸ“ï¼ˆSSRï¼‰çš„æ¡†æ¶

----

###  Start a nuxt project
```bash=
yarn create nuxt-app first_nuxt_app
```

----

åŸºæœ¬ä¸Šå°±çœ‹è‡ªå·±éœ€è¦ä»€éº¼æ±è¥¿
å¦‚æœä¸çŸ¥é“çš„è©±å¯ä»¥ç…§æˆ‘çš„
![](https://i.imgur.com/UTIg6uE.png)
ç”¨ â†‘ â†“ ç©ºæ ¼ æ“ä½œ
é¸å®ŒæŒ‰Enterå°±å¥½äº†

----

### æ¥è‘—é€²åˆ°å‰›å‰›å»ºå¥½çš„å°ˆæ¡ˆçœ‹çœ‹

å¯ä»¥ä¸‹yarn devæŠŠä»–è·‘èµ·ä¾†
![](https://i.imgur.com/r57Itr6.png)

---

### NuxtåŸç†
![](https://i.imgur.com/sIdiO9v.png)

----

### æ¥è‘—æŠŠé€™å€‹å°ˆæ¡ˆcloneä¸‹ä¾†
```bash=
git clone https://github.com/kukina622/todolist_nuxt_frontend.git
yarn install #è¨˜å¾—è¼‰å®Œè¦installã„›
```

----

## å¥½äº†ä¹‹å¾Œå°±é–‹å§‹å›‰

---

## å…ˆä¾†è¬›ä¸‹è³‡æ–™å¤¾

----

### pages
ç”¨ä¾†å°æ‡‰è·¯ç”±çš„é é¢
å‡ä½¿æˆ‘æœ‰ä¸€å€‹page1.vueçš„çµ„ä»¶
127.0.0.1/page1å°±æœƒè‡ªå‹•æ‡‰åˆ°å®ƒ

----

### layouts
æ”¾ç½®pageè£¡å…±é€šçš„çµ„ä»¶ï¼Œåƒheaderã€footeré€™ç¨®ï¼Œ
é€™æ¨£å°±ä¸ç”¨åœ¨æ¯å€‹é é¢ä¸Šå¯«é‡è¤‡çš„æ±è¥¿

----

layoutsä¸­å¯ä»¥ä½¿ç”¨<Nuxt />é€™å€‹çµ„ä»¶
å®ƒæœƒæŠŠpagesçµ„ä»¶æ³¨å…¥é€²å»ï¼Œä»¥æ­¤ä¾†é”æˆå›ºå®šä½ˆå±€çš„æ•ˆæœã€‚
![](https://i.imgur.com/DW8n2s0.png)
layouts/default.vue

----

ç”¨æ³•æ˜¯åœ¨exportè£¡åŠ ä¸€å€‹layoutçš„å±¬æ€§å°±å¥½äº†ï¼Œå¦‚æœæ²’å¯«çš„è©±ï¼Œå®ƒæœƒè‡ªå‹•å¥—ç”¨default
```javascript=
<script>
export default {
  layout: 'blog',
  // OR
  layout (context) {
    return 'blog'
  }
}
</script>
```

----

### assetsã€static
é€™å…©å€‹éƒ½æ˜¯æ”¾éœæ…‹è³‡æºçš„ï¼Œå°±ä¸€èµ·è¬›äº†
* assets: æ”¾éœ€è¦è¢«ç·¨è­¯ (webpacked) çš„æª”æ¡ˆ
* static: ä¸éœ€é¡å¤–è™•ç†çš„æª”æ¡ˆï¼Œä¾‹å¦‚ç¶²ç«™icon (favicon.ico)ã€è¨­å®šæª” (robots.txtã€sitemap.xml ã€CNAME) ç­‰ç­‰

----

### components
å°±è·ŸVueçš„å·®ä¸å¤šï¼Œæ”¾çµ„ä»¶çš„åœ°æ–¹

---

### plugins
ç”¨ä¾†æ”¾å®¢è£½åŒ–æ’ä»¶çš„åœ°æ–¹ï¼Œèƒ½å¤ æŠŠè‡ªè£½æ’ä»¶æ³¨å…¥åˆ°Vueå¯¦ä¾‹ä¸Š

----

ä½¿ç”¨æ™‚éœ€è¦exportä¸€å€‹functionï¼Œå‚³å…¥çš„ç¬¬ä¸€å€‹åƒæ•¸æ˜¯ä¸€å€‹contextç‰©ä»¶ï¼Œæœ‰é»åƒåœ¨çµ„ä»¶è£¡çš„thisï¼Œè£¡é¢æä¾›å¾ˆå¤šnuxtçš„æ–¹æ³•ã€‚ä¾‹å¦‚routeã€app

[contextè©³ç´°å±¬æ€§](https://nuxtjs.org/docs/internals-glossary/context/)

----

å¯«èµ·ä¾†å¤§æ¦‚é•·é€™æ¨£
plugins/api.js
![](https://i.imgur.com/rfvrcZa.png)

----

æˆ‘å€‘è¦åšçš„å°±æ˜¯æŠŠè‡ªå»ºæ’ä»¶ç¶åœ¨context.appä¸Š
```javascript=
context.app.$customPlugin = yourCustomPlugin
```
é€™æ¨£å…¶ä»–åœ°æ–¹çš„context.appå°±æœƒéƒ½æœ‰$customPluginé€™å€‹methodäº†

----

å¦‚æœæ²’æœ‰contextçš„åœ°æ–¹å‘¢ï¼Œæˆ‘å€‘ä¹Ÿå¯ä»¥ç¶åœ¨Vueå¯¦ä¾‹ä¸Š
```javascript=
import Vue from 'vue'
Vue.prototype.customPlugin = yourCustomPlugin
```
é€™æ¨£å°±èƒ½ä½¿ç”¨this.$customPluginä½¿ç”¨äº†

----

å¦‚æœå…©å€‹éƒ½è¦ï¼Ÿé‚£å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ç¬¬äºŒå€‹åƒæ•¸äº†ã€‚
ç¬¬äºŒå€‹åƒæ•¸å‚³å…¥çš„æ˜¯ä¸€å€‹injectçš„function
```javascript=
// å‰é¢æœƒè‡ªå¸¶$
inject("customPlugin",yourCustomPlugin)
```

----

æœ€å¾Œåªè¦åœ¨nuxt.config.jsè¨­å®š  
![](https://i.imgur.com/ln4hMR6.png)

---

### middleware
æœƒåœ¨ä¸€å€‹é é¢renderä¹‹å‰åŸ·è¡Œçš„ç¨‹å¼ã€‚
ä¾‹å¦‚é©—è­‰ä½¿ç”¨è€…æ¬Šé™ä¹‹é¡çš„åŠŸèƒ½ï¼Œå°±æœƒä»¥middlewareçš„æ–¹å¼ä¾†è™•ç†ã€‚

----

å¿…é ˆè¦exportä¸€å€‹å‡½å¼ï¼Œå‚³å…¥çš„åƒæ•¸ä¹Ÿæ˜¯contextç‰©ä»¶

----

å¦‚æœæˆ‘å€‘è¦é¿å…å·²ç™»å…¥ç”¨æˆ¶é€²åˆ°è¨»å†Šé é¢
å°±å¯ä»¥é€™æ¨£å¯«
```javascript
export default async function ({ app, redirect }) {
  // ç¢ºèªç”¨æˆ¶æ˜¯å¦ç™»å…¥   
  const { isLogin } = (await app.$api.user.isLogin()).data
  if (isLogin) { // å¦‚æœç™»å…¥çš„è©±
    // é‡å°å‘è‡³ '/'
    return redirect('/')
  }
}
```
middleware/auth.js

----

è¦ä½¿ç”¨çš„è©±å°±åœ¨çµ„ä»¶è£¡æ·»åŠ ä¸€å€‹å±¬æ€§å°±èƒ½ç”¨äº†
pages/register.vue
![](https://i.imgur.com/UDpzaaX.png)

è¦å¤šå€‹middlewareè©±ï¼Œå¯ä»¥å¡«é™£åˆ—ï¼Œä»–æœƒæ ¹æ“šé †åºå»è·‘
![](https://i.imgur.com/rFpNAHj.png)

---

## æ¥ä¸‹ä¾†è¦ä¾†è¬›nuxtç‰¹åˆ¥çš„æ±è¥¿

----

### asyncData
åªèƒ½åœ¨pagesè£¡ä½¿ç”¨ï¼Œæœƒåœ¨serverç«¯æ¸²æŸ“æ™‚ï¼Œå°±å…ˆè¢«åŸ·è¡Œï¼Œé€šå¸¸æ˜¯ç”¨ä¾†å‘¼å«APIçš„ï¼Œè€Œå›å‚³çš„æ±è¥¿æœƒå–ä»£data

----

æˆ‘å€‘ç›´æ¥ä¾†çœ‹ç¯„ä¾‹
![](https://i.imgur.com/NqlN9oj.png)

pages/index.vue

----

dataçš„æ±è¥¿æœƒè®Šæˆ
```javascript=
export default {
    data() {
        return {
            isLogin: ...,
            tasks: ...
        }
    }
}
```
ä¹‹å¾Œçš„æ“ä½œå°±è·Ÿä¹‹å‰ä¸€æ¨£å°±å¥½äº†
ä¹Ÿæ˜¯ç”¨thiså­˜å–

----

![](https://i.imgur.com/Wiz4RJN.png)

---

## End