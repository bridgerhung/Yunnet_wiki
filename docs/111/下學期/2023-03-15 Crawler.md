---
title: ç¶²è·¯çˆ¬èŸ²
sidebar_position: 2
description: Python Selenium ç¶²è·¯çˆ¬èŸ²
Date: 2023/03/15
---

:::info ä½œè€…è³‡æ–™
[åŸå§‹ MD by è£•ç¿”](https://hackmd.io/@SnackeyesBoy77/rJK2MeSkh#/)
:::


#### åˆæ¢ç¶²è·¯çˆ¬èŸ²

---

## [è½èªªä¸Šå­¸æœŸä½ å€‘æœ‰ç¢°é](/111/ä¸Šå­¸æœŸ/2022-12-28%20cookie%20and%20session)

---

## å…ˆç°¡ä»‹ä¸€ä¸‹ä»€éº¼æ˜¯ç¶²è·¯çˆ¬èŸ²
![](https://i.imgur.com/FJqsQFs.png)


----

### è©¦æƒ³çœ‹çœ‹æœ‰æƒ³å¤§é‡ä¸‹è¼‰åœ–ç‰‡
### ä½†ä½ åˆå¾ˆæ‡¶

----

# é‚£è©²æ€éº¼è¾¦å‘¢?

----

## ~~å»ç¡è¦ºå§!~~
## å¤¢è£¡ç”šéº¼éƒ½æœ‰
### å‘¸å‘¸å‘¸!!

----

### ç°¡å–®ä¾†èªªå°±æ˜¯è®“ä½ ç•¶æ…£è€é—†
### ä½¿ç”¨ç¶²è·¯çˆ¬èŸ²ä¾†æ›¿ä½ å·¥ä½œ

----

### å¯ä»¥åšäº›ç”šéº¼å‘¢?
#### å¹«ä½ ä¸‹è¼‰ç¾å¥³çš„ç…§ç‰‡ã€çˆ¬æ–‡ã€æ¶Black pinkçš„ç¥¨ç­‰ç­‰
![](https://i.imgur.com/kdSWxXN.png)

----

### åŸºæœ¬ä¸Šå°±æ˜¯è®“çˆ¬èŸ²å½è£æˆç€è¦½å™¨å»çˆ¬å–ä½ è¦çš„è³‡æ–™
### æˆ–ä¸‹é”æŒ‡ä»¤çµ¦çˆ¬èŸ²åŸ·è¡Œ
![](https://i.imgur.com/KH2dmBb.png)

----

### çˆ¬èŸ²ä¹‹å‰å¿…é ˆçŸ¥é“çš„äº‹
* æœƒéœ€è¦å…ˆèªè­˜ç¶²ç«™æ¶æ§‹ï¼ŒEx. HTML
* è¦ç•¶å€‹æœ‰é“å¾·çš„çˆ¬èŸ²(!?

---

# Selenium
[å®˜ç¶²ä»‹ç´¹](https://selenium-python.readthedocs.io/installation.html)
## å‰ç½®ä½œæ¥­

:::note åç®çš„ä¿®å¾©ç’°å¢ƒç­†è¨˜ 
> **For Linux**

1. å®‰è£python ç’°å¢ƒ


```bash showLineNumbers
sudo apt install python3.9 
apt install pipenv
sudo apt-get install python3-pip
```

:::


----

:::tip é€™è£¡é †ä¾¿æä¸€ä¸‹pipenv
è«‹ä½¿ç”¨ä¸‹åˆ—ç¨‹å¼ç¢¼å˜—è©¦å®‰è£ selenium
:::
```python showLineNumbers
pip3 install pipenv
pipenv install selenium
pip install selenium
```
![](https://i.imgur.com/s0FyZFO.png)
### å¯ä»¥å…ˆç¢ºèªæ˜¯å¦å®‰è£æˆåŠŸ


----

### ä¸‹è¼‰Chrome Driver
[Here](https://https://chromedriver.chromium.org/downloads)
##### Chrome -> Setting  -> About Chrome -> Chrome Version
![](https://i.imgur.com/0EveoCT.png)
#### è¨˜å¾—å°ç…§ç‰ˆæœ¬ä¸‹è¼‰
#### è§£å£“ç¸®åˆ°æ¡Œé¢



---

## èªæ³•æ•™å­¸


----

### ç’°å¢ƒè¨­å®š

```python showLineNumbers
from selenium import webdriver
from selenium.webdriver.support.ui import Select,WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
import requests 
from bs4 import BeautifulSoup
import io
import time

```

----

### èµ·æ‰‹å¼

```python showLineNumbers
PATH = " " //Chrome Driverçš„ä½ç½®
driver = webdriver.Chrome //æ‰€éœ€ä½¿ç”¨çš„ç€è¦½å™¨
driver.get(" ") //Chrome Driverè¦é–‹å•Ÿçš„ç¶²é 
```
##### Macçš„éƒ¨åˆ†å¯ä»¥æŠŠChrome DriveråŠ å…¥åˆ°binçš„ç’°å¢ƒè®Šæ•¸ä¸­
```
/usr/local/bin
```

----

### Example
```python showLineNumbers
Path = "/usr/local/bin/chromedriver.exe"#chromedriver path
driver = webdriver.Chrome()#open browser
driver.get("https://www.dcard.tw/f")
```

```
==>é–‹å•ŸDcardé¦–é 
```

----

## å¿…å‚™çŸ¥è­˜

----

#### æ¨™ç±¤ç¨®é¡
![](https://i.imgur.com/b56mALA.png)
##### å¸¸ç”¨çš„æœƒåƒæ˜¯name,class,id...

----


### æ™®é€šæ“ä½œ
```python showLineNumbers
print(driver.title) //ç¶²é åç¨±
search = driver.find_element(HTMLæ¨™ç±¤, "æ¨™ç±¤åç¨±" )
search.clear() //æ¸…é™¤é è¨­æ–‡å­—
search.send_keys("æœå°‹åç¨±")
time.sleep(ç§’æ•¸) //ä½¿çˆ¬èŸ²åœç­‰æ™‚é–“
search.send_keys(Keys.RETURN) //æŒ‰ä¸‹Enter
```

----

### Example
```python showLineNumbers
print(driver.title)
search = driver.find_element(By.NAME, "query" )
search.clear()
search.send_keys("æ¯”ç‰¹å¹£")
time.sleep(3)
search.send_keys(Keys.RETURN)

```
```
==>å‡ºç¾æœ‰é—œæ¯”ç‰¹å¹£çš„æœå°‹çµæœ
```

----

### å–å¾—æ–‡ç« æ¨™é¡Œ
```python showLineNumbers
WebDriverWait(driver, 10).until(
        EC.presence_of_element_located((By.CLASS_NAME, "atm_26_loj7t9"))
    ) //ç­‰åˆ°è®€åˆ°æŒ‡å®šæ¨™ç±¤ï¼Œåœ¨åŸ·è¡Œä¸‹é¢çš„ç¨‹å¼

titles = driver.find_elements(By.CLASS_NAME, "atm_cs_1urozh")
for title in titles :
    print(title.text) //è¿´åœˆ
```

![](https://i.imgur.com/lV75kZe.png)

---


## ä¾†åšå€‹å¥½ç©æ±è¥¿!

::::warning è­¦å‘Šï¼ŒåŠå…è²¬è²æ˜
ä»¥ä¸‹éŠæˆ²å…§å®¹å¯èƒ½å¼•èµ·éƒ¨åˆ†äººå€‘ä¸é©  
è‹¥æ‚¨å°æ–¼***æ€§åˆ¥è­°é¡Œ*** æˆ– ***æ€§*** ç›¸é—œè­°é¡Œæœ‰è¼ƒç‚ºå¼·çƒˆçš„ä¸»å¼µï¼Œ  
**è«‹åœ¨æ­¤æ‰“ä½**ã€‚

:::tip æ­¤éŠæˆ²å…§å®¹æ¶µæ„
ç‚ºä¸€æ¬¾æ”¿æ²»åŠç¤¾æœƒè«·åˆºéŠæˆ²  
è«‹å‹¿èªçœŸå°å¾…  
:::
  
::::

#### ä¾†ç©å€‹ç¶²é å°éŠæˆ²

:::warning éŠæˆ²ç¶²ç«™ 
  
### [TSJ](https://tsj.tw)  
  
:::

> è‹¥æœ‰é›·åŒå­˜å±¬å·§åˆ



----

#### å…ˆå»ºæ§‹ç’°å¢ƒè·Ÿè¦é–‹çš„ç¶²é 
```python showLineNumbers
from selenium import webdriver
from selenium.webdriver.common.action_chains import ActionChains
from selenium.webdriver.support.ui import Select,WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
import requests 
from bs4 import BeautifulSoup
import io

PATH = "/usr/local/bin/chromedriver.exe"
driver = webdriver.Chrome(PATH)
driver.get("https://tsj.tw/")
```

----

#### é»æ“ŠæŒ‰éˆ•ä½ç½®
#### æ¬¡æ•¸
```
blow = driver.find_element(By.ID,'click')
blow_count = driver.find_element(By.XPATH, '//*[@id="app"]/div[2]/div[4]/div[2]/h4[2]')
```
###### tags: è¨˜å¾—æœ€å¤–å±¤è¦æŠŠ"è“‹æˆ'

----

#### ç­‰ç­‰? XPath?
![](https://i.imgur.com/7qC7sCV.png)
#### ç°¡å–®ä¾†èªªå°±æ˜¯ç‰©ä»¶åœ¨HTMLä¸­çš„çµ•å°ä½ç½®
##### è‹¥è¦æ‰¾çš„æ±è¥¿æ¨™ç±¤é‡è¤‡ï¼Œå°±å¯ä»¥ç”¨ä¾†æŒ‡å®šä½ç½®~



----


#### è®€å–å•†å“æŒ‰éˆ•
```python showLineNumbers
items = []
items.append(driver.find_element(By.XPATH, '//*[@id="app"]/div[2]/div[4]/div[4]/table/tbody/tr[4]/td[5]/button[1]'))
items.append(driver.find_element(By.XPATH, '//*[@id="app"]/div[2]/div[4]/div[4]/table/tbody/tr[3]/td[5]/button[1]'))
items.append(driver.find_element(By.XPATH, '//*[@id="app"]/div[2]/div[4]/div[4]/table/tbody/tr[2]/td[5]/button[1]'))
```

----

#### è®€å–å•†å“åƒ¹æ ¼
```python showLineNumbers
prices = []
prices.append(driver.find_element(By.XPATH, '//*[@id="app"]/div[2]/div[4]/div[4]/table/tbody/tr[4]/td[4]'))
prices.append(driver.find_element(By.XPATH, '//*[@id="app"]/div[2]/div[4]/div[4]/table/tbody/tr[3]/td[4]'))
prices.append(driver.find_element(By.XPATH, '//*[@id="app"]/div[2]/div[4]/div[4]/table/tbody/tr[2]/td[4]'))
```


----

#### å‰ç½®é»æ“Šå™¨


```python showLineNumbers
actions = ActionChains(driver)#æ“ä½œæ»‘é¼ 
for n in range(10):
    actions.click(blow)
```

----

#### è‡ªå‹•è³¼è²·é“å…·
```python showLineNumbers
for i in range(10000):
    actions.perform() #å‹•ä½œåŸ·è¡Œ
    count = int(blow_count.text.replace("æ‚¨ç›®å‰æ“æœ‰", "").replace("æŠ€è¡“é»", "")) #æ›¿æ›æ‰å­—ä¸²ç‚ºç©ºå­—ä¸²åªç•™æ•¸å­—
    for j in range(3): #è·‘ä¸‰æ¬¡å»æ¯”åƒ¹
        price = int(prices[j].text.replace("æŠ€è¡“é»", ""))
        if count >= price: #è³¼è²·
            upgrade_actions = ActionChains(driver)
            upgrade_actions.move_to_element(items[j])
            upgrade_actions.click()
            upgrade_actions.perform() #å‹•ä½œåŸ·è¡Œ
            break
```

## å…¨éƒ¨ç¨‹å¼ç¢¼
:::caution æé†’
**æœ¬ç¨‹å¼ç¢¼å¯èƒ½ç„¡æ³•åœ¨éƒ¨åˆ†é›»è…¦ç’°å¢ƒä¸Šé¢æ­£å¸¸åŸ·è¡Œ**  
  
[**githubå°ˆæ¡ˆç¯„ä¾‹é€£çµ**](https://github.com/hibyby/GrandmaCan_python_selenium/blob/main/project1.py)
:::

```python showLineNumbers
# Action Chains è‡ªå‹•ç©ç¶²é å°éŠæˆ²
from selenium import webdriver
from selenium.webdriver.common.action_chains import ActionChains
from selenium.webdriver.support.ui import Select,WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
import requests 
from bs4 import BeautifulSoup
import io

PATH = "/usr/local/bin/chromedriver.exe"
driver = webdriver.Chrome(PATH)
driver.get("https://tsj.tw/%22)

blow = driver.find_element(By.ID,'click')
blow_count = driver.find_element(By.XPATH, '//[@id="app"]/div[2]/div[4]/div[2]/h4[2]')

items = []
items.append(driver.find_element(By.XPATH, '//[@id="app"]/div[2]/div[4]/div[4]/table/tbody/tr[4]/td[5]/button[1]'))
items.append(driver.find_element(By.XPATH, '//[@id="app"]/div[2]/div[4]/div[4]/table/tbody/tr[3]/td[5]/button[1]'))
items.append(driver.find_element(By.XPATH, '//[@id="app"]/div[2]/div[4]/div[4]/table/tbody/tr[2]/td[5]/button[1]'))

prices = []
prices.append(driver.find_element(By.XPATH, '//[@id="app"]/div[2]/div[4]/div[4]/table/tbody/tr[4]/td[4]'))
prices.append(driver.find_element(By.XPATH, '//[@id="app"]/div[2]/div[4]/div[4]/table/tbody/tr[3]/td[4]'))
prices.append(driver.find_element(By.XPATH, '//*[@id="app"]/div[2]/div[4]/div[4]/table/tbody/tr[2]/td[4]'))

actions = ActionChains(driver)

for n in range(10):
    # actions.perform()
    actions.click(blow)

for i in range(10000):
    actions.click(blow)
    actions.perform()
    count = int(blow_count.text.replace("æ‚¨ç›®å‰æ“æœ‰", "").replace("æŠ€è¡“é»", ""))
    for j in range(3):
        price = int(prices[j].text.replace("æŠ€è¡“é»", ""))
        if count >= price:
            upgrade_actions = ActionChains(driver)
            upgrade_actions.move_to_element(items[j])
            upgrade_actions.click()
            upgrade_actions.perform()
            break
```

---

## ä¸å¤ éç™®ï¼Ÿ
[Examples](https://blog.jiatool.com/series/pythonç¶²è·¯çˆ¬èŸ²å¯¦ä¾‹/)
###### ~~å­¸é•·æ•™å¤ªçˆ›~~ğŸ¥²


---

# ğŸ”¥ğŸ¦(ä¹¾è¦)
#### æœŸå¾…ä½ å€‘èƒ½å¤ åšå‡ºğŸ®ğŸºçš„æ©Ÿå™¨äºº~~


